## 问题分析
- 初始渲染容器尺寸为 0 或未稳定，`WebGLRenderer` 仅监听 `window.resize`，导致首次 `setSize` 与相机宽高比错误，出现黑屏；切换设备模式触发尺寸事件后才恢复。
- `PanoramaPlayer` 在超时（1s）时会提前隐藏加载层并调用 `onVideoReady`，但 `onVideoReady` 会在 `readyState` 不足时延迟/强制创建纹理；导致加载层消失且纹理未创建，画面黑屏。
- 移动端自动播放可能被策略拦截；未进行首帧预解码与 `requestVideoFrameCallback` 首帧确认，导致视频首帧未显示。

## 解决方案概述
1. 尺寸稳定：为 `WebGLRenderer` 恢复 `ResizeObserver + orientationchange + window.resize` 三重监听，首次观察到容器尺寸>0立即 `resize`，避免初始黑屏。
2. 首帧就绪控制：在 `PanoramaPlayer` 仅在 `loadeddata/canplay/playing` 或捕获到首帧渲染后隐藏加载层；移除 1s 强制隐藏逻辑。
3. 视频首帧保障：在 `useVideoLoader` 设置 src 后显式 `video.load()`；在 `loadedmetadata` 后执行一次 0.001 秒 `currentTime` 探测与 `play/pause` 预解码（静音），确保有首帧；失败时忽略。
4. 帧同步：`WebGLRenderer` 已优先使用 `requestVideoFrameCallback`，维持每帧 `needsUpdate`；保持对无法使用 rVFC 的设备的 33ms 定时器回退。
5. 可靠的 ready 通知：`onVideoReady` 创建纹理后，通过 rVFC 确认首帧渲染，再发射 `ready` 并关闭加载层。

## 具体改动
### A. WebGLRenderer（src/renderers/WebGLRenderer.ts）
- 恢复 `setupResponsiveResize()`：
  - 使用 `ResizeObserver` 监听容器尺寸（100ms 防抖），当 `entry.contentRect.width/height>0` 执行 `resize(width, height)`。
  - 监听 `orientationchange` 与 `resize`，延迟 300ms 后 `resize`。
- 初始化时若 `container.clientWidth/Height` 为 0，延迟到 `nextTick` 或首次 `ResizeObserver` 回调后再 `setSize` 与更新相机。

### B. PanoramaPlayer（src/components/PanoramaPlayer.vue）
- 删除当前 1s 超时 `forceShowTimeout` 隐藏加载层的逻辑（约 439-469 行）；改为：
  - 在 `loadeddata/canplay/playing` 任一事件触发后：调用 `renderer.onVideoReady(video)`，再通过 rVFC 监听首帧；收到首帧后隐藏加载层与发射 `ready`。
- 维持自动播放但失败不隐藏加载层；仅在 `loadeddata` 或 `canplay` 后切换。

### C. useVideoLoader（src/composables/useVideoLoader.ts）
- `loadVideo(cfg)`：
  - 设置属性后立即 `video.load()`。
  - 等待 `loadedmetadata`（加 1500ms 超时兜底）。
  - 尝试 `currentTime = 0.001` 与一次 `play/pause` 预解码（静音）；失败忽略。
- HLS：保持 iOS 原生与 hls.js 分支；确保 attach 后能触发 `canplay`。

## 验证步骤
- 桌面与移动设备（Chrome、Safari、微信内核）：
  - 首次进入无黑屏，加载层显示直至 `loadeddata` 与首帧渲染；随后显示全景视频。
  - 切换设备模式不再影响是否加载成功。
  - 自动播放失败时仍能显示首帧（静音预解码），用户可点击外部控件继续播放。
- 断网/慢网：加载层不提前隐藏；出现错误时显示错误提示并可重试。

## 影响面与回滚
- 主要改动集中于尺寸监听、加载层隐藏时机与视频预解码；无数据结构与 API 破坏。
- 可通过保留的降级渲染（CSS3D/Fallback）保证非 WebGL 浏览器可见内容。

请确认以上方案，我将据此提交具体代码改动并进行本地验证（含桌面与移动端模拟）。